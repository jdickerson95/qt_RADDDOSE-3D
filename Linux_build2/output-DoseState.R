# Crystal dose state visualization using R
# http://www.r-project.org/
#
# Code generated 2021-09-09 15:06:40
# Crystal size: 11 x 11 x 11 voxels
#

contourlevels <- c(0.1, 20, 30) # MGy
contourcolours <- c('lightblue', 'darkblue', 'red')
contouropacity <- c(0.2, 0.5, 1)

require("rgl")
require("misc3d")

# Three dimensional dose array (MGy)
dose <- array(0, c(11, 11, 11))
dose[,,1]<-c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
dose[,,2]<-c(4.7411136E-6,1.12319985E-5,8.820909E-4,0.0363025,0.43163773,1.6660205,2.7013054,2.7605286,2.478155,2.1831768,0,7.889423E-6,1.8690544E-5,0.0014678383,0.060408972,0.71826434,2.7723322,4.495092,4.5936418,4.1237597,3.6329029,0,1.1723638E-5,2.7774042E-5,0.0021811994,0.08976739,1.0673367,4.1196694,6.679681,6.8261256,6.127883,5.398473,0,1.5557212E-5,3.685602E-5,0.0028944414,0.1191209,1.4163508,5.466782,8.863905,9.058237,8.131672,7.1637483,0,1.8435436E-5,4.3674718E-5,0.0034299388,0.14115934,1.6783884,6.478186,10.503807,10.734092,9.636105,8.489106,0,1.9508652E-5,4.6217236E-5,0.0036296125,0.14937691,1.7760956,6.855313,11.115285,11.358975,10.197069,8.983298,0,1.8435436E-5,4.3674718E-5,0.0034299388,0.14115934,1.6783884,6.478186,10.503807,10.734092,9.636105,8.489106,0,1.5557212E-5,3.685602E-5,0.0028944414,0.1191209,1.4163508,5.466782,8.863905,9.058237,8.131672,7.1637483,0,1.1723638E-5,2.7774042E-5,0.0021811994,0.08976739,1.0673367,4.1196694,6.679681,6.8261256,6.127883,5.398473,0,7.889423E-6,1.8690544E-5,0.0014678383,0.060408972,0.71826434,2.7723322,4.495092,4.5936418,4.1237597,3.6329029,0,0,0,0,0,0,0,0,0,0,0,0)
dose[,,3]<-c(7.1423844E-4,8.5738156E-4,0.0022438937,0.049637783,0.57983017,2.233779,3.5410628,3.4428613,2.9263768,2.478155,0,0.0011885244,0.001426721,0.0037339386,0.082599476,0.96486306,3.717107,5.8924856,5.729074,4.869621,4.1237597,0,0.0017661405,0.0021200993,0.0055486113,0.12274235,1.433781,5.5236,8.7562,8.513371,7.2362285,6.127883,0,0.0023436602,0.0028133616,0.0073629813,0.16287851,1.9026207,7.329791,11.619436,11.297204,9.602441,8.131672,0,0.0027772582,0.0033338587,0.008725199,0.1930125,2.2546225,8.685868,13.769136,13.387287,11.378979,9.636105,0,0.002938936,0.003527939,0.009233136,0.20424871,2.3858752,9.191515,14.570705,14.166627,12.041405,10.197069,0,0.0027772582,0.0033338587,0.008725199,0.1930125,2.2546225,8.685868,13.769136,13.387287,11.378979,9.636105,0,0.0023436602,0.0028133616,0.0073629813,0.16287851,1.9026207,7.329791,11.619436,11.297204,9.602441,8.131672,0,0.0017654266,0.0021200993,0.0055486113,0.12274235,1.433781,5.5236,8.7562,8.513371,7.2362285,6.127883,0,0.0011885244,0.001426721,0.0037339386,0.082599476,0.96486306,3.717107,5.8924856,5.729074,4.869621,4.1237597,0,0,0,0,0,0,0,0,0,0,0,0)
dose[,,4]<-c(0.029095002,0.03526751,0.04864178,0.15241629,1.0475255,3.5477188,5.0740285,4.412573,3.4428613,2.7605286,0,0.048415374,0.058686703,0.08094207,0.25362748,1.7431289,5.9035616,8.443409,7.342717,5.729074,4.5936418,0,0.07194497,0.08720811,0.12027946,0.37688896,2.5902796,8.772658,12.546857,10.911236,8.513371,6.8261256,0,0.09547064,0.11572474,0.15961027,0.5001299,3.4372888,11.641277,16.64962,14.479158,11.297204,9.058237,0,0.11313356,0.13713486,0.1891396,0.5926584,4.073218,13.795017,19.72995,17.157932,13.387287,10.734092,0,0.11971962,0.14511815,0.20015036,0.62715995,4.31034,14.598093,20.878527,18.15678,14.166627,11.358975,0,0.11313356,0.13713486,0.1891396,0.5926584,4.073218,13.795017,19.72995,17.157932,13.387287,10.734092,0,0.09547064,0.11572474,0.15961027,0.5001299,3.4372888,11.641277,16.64962,14.479158,11.297204,9.058237,0,0.07194497,0.08720811,0.12027946,0.37688896,2.5902796,8.772658,12.546857,10.911236,8.513371,6.8261256,0,0.048415374,0.058686703,0.08094207,0.25362748,1.7431289,5.9035616,8.443409,7.342717,5.729074,4.5936418,0,0,0,0,0,0,0,0,0,0,0,0)
dose[,,5]<-c(0.34077668,0.4192651,0.56745625,1.0359312,3.0209808,6.623998,7.168446,5.0740285,3.5410628,2.7013054,0,0.5670675,0.6976757,0.94427234,1.7238356,5.027046,11.022627,11.928613,8.443409,5.8924856,4.495092,0,0.8426591,1.0367421,1.4031833,2.5616097,7.470162,16.37956,17.72585,12.546857,8.7562,6.679681,0,1.1182047,1.3757519,1.8620178,3.399244,9.912869,21.7356,23.52212,16.64962,11.619436,8.863905,0,1.3250825,1.6302782,2.2065077,4.028135,11.74684,25.75688,27.873922,19.72995,13.769136,10.503807,0,1.4022222,1.7251848,2.3349593,4.2626324,12.43068,27.256315,29.4966,20.878527,14.570705,11.115285,0,1.3248558,1.6302782,2.2065077,4.028135,11.74684,25.75688,27.873922,19.72995,13.769136,10.503807,0,1.1182047,1.3757519,1.8620178,3.399244,9.912869,21.7356,23.52212,16.64962,11.619436,8.863905,0,0.8426591,1.0367421,1.4031833,2.5616097,7.470162,16.37956,17.72585,12.546857,8.7562,6.679681,0,0.5670675,0.6976757,0.94427234,1.7238356,5.027046,11.022627,11.928613,8.443409,5.8924856,4.495092,0,0,0,0,0,0,0,0,0,0,0,0)
dose[,,6]<-c(1.2988422,1.6177145,2.1851144,3.5008245,6.5916166,9.062808,6.623998,3.5477188,2.233779,1.6660205,0,2.161331,2.6919487,3.6361272,5.825527,10.968742,15.0809145,11.022627,5.9035616,3.717107,2.7723322,0,3.2117255,4.0002203,5.4032645,8.6567,16.299488,22.410152,16.37956,8.772658,5.5236,4.1196694,0,4.261945,5.308274,7.1701064,11.4874,21.629343,29.738167,21.7356,11.641277,7.329791,5.466782,0,5.0504427,6.290352,8.49664,13.612672,25.630966,35.239994,25.75688,13.795017,8.685868,6.478186,0,5.338565,6.656544,8.991272,14.405132,27.12307,37.29149,27.256315,14.598093,9.191515,6.855313,0,5.0504427,6.290352,8.49664,13.612672,25.630966,35.239994,25.75688,13.795017,8.685868,6.478186,0,4.261945,5.308274,7.1701064,11.4874,21.629343,29.738167,21.7356,11.641277,7.329791,5.466782,0,3.2117255,4.0002203,5.4032645,8.6567,16.299488,22.410152,16.37956,8.772658,5.5236,4.1196694,0,2.161331,2.6919487,3.6361272,5.825527,10.968742,15.0809145,11.022627,5.9035616,3.717107,2.7723322,0,0,0,0,0,0,0,0,0,0,0,0)
dose[,,7]<-c(2.1276155,2.6207318,3.4613779,5.001255,7.1096444,6.5916166,3.0209808,1.0475255,0.57983017,0.43163773,0,3.5404465,4.361014,5.7598863,8.32231,11.830763,10.968742,5.027046,1.7431289,0.96486306,0.71826434,0,5.2610836,6.480442,8.559158,12.366905,17.580446,16.299488,7.470162,2.5902796,1.433781,1.0673367,0,6.981433,8.599516,11.357963,16.410826,23.32917,21.629343,9.912869,3.4372888,1.9026207,1.4163508,0,8.273025,10.190503,13.459287,19.446976,27.645275,25.630966,11.74684,4.073218,2.2546225,1.6783884,0,8.754676,10.783743,14.242818,20.579079,29.254642,27.12307,12.43068,4.31034,2.3858752,1.7760956,0,8.273061,10.190503,13.459287,19.446976,27.645275,25.630966,11.74684,4.073218,2.2546225,1.6783884,0,6.981433,8.599516,11.357963,16.410826,23.32917,21.629343,9.912869,3.4372888,1.9026207,1.4163508,0,5.2610836,6.480442,8.559158,12.366905,17.580446,16.299488,7.470162,2.5902796,1.433781,1.0673367,0,3.5404465,4.361014,5.7598863,8.32231,11.830763,10.968742,5.027046,1.7431289,0.96486306,0.71826434,0,0,0,0,0,0,0,0,0,0,0,0)
dose[,,8]<-c(2.2190952,2.6736999,3.360929,4.3370605,5.001255,3.5008245,1.0359312,0.15241629,0.049637783,0.0363025,0,3.692673,4.449155,5.5927353,7.2170606,8.32231,5.825527,1.7238356,0.25362748,0.082599476,0.060408972,0,5.487291,6.6114187,8.310772,10.724511,12.366905,8.6567,2.5616097,0.37688896,0.12274235,0.08976739,0,7.2580466,8.773322,11.028356,14.231376,16.410826,11.4874,3.399244,0.5001299,0.16287851,0.1191209,0,8.628772,10.396465,13.068701,16.864307,19.446976,13.612672,4.028135,0.5926584,0.1930125,0.14115934,0,9.131095,11.001695,13.8294935,17.846062,20.579079,14.405132,4.2626324,0.62715995,0.20424871,0.14937691,0,8.628772,10.396465,13.068701,16.864307,19.446976,13.612672,4.028135,0.5926584,0.1930125,0.14115934,0,7.281609,8.773322,11.028356,14.231376,16.410826,11.4874,3.399244,0.5001299,0.16287851,0.1191209,0,5.487291,6.6114187,8.310772,10.724511,12.366905,8.6567,2.5616097,0.37688896,0.12274235,0.08976739,0,3.692673,4.449155,5.5927353,7.2170606,8.32231,5.825527,1.7238356,0.25362748,0.082599476,0.060408972,0,0,0,0,0,0,0,0,0,0,0,0)
dose[,,9]<-c(2.0637062,2.3949997,2.8484423,3.360929,3.4613779,2.1851144,0.56745625,0.04864178,0.0022438937,8.820909E-4,0,3.4340985,3.985386,4.739934,5.5927353,5.7598863,3.6361272,0.94427234,0.08094207,0.0037339386,0.0014678383,0,5.0742903,5.9222603,7.043515,8.310772,8.559158,5.4032645,1.4031833,0.12027946,0.0055486113,0.0021811994,0,6.771724,7.858812,9.346711,11.028356,11.357963,7.1701064,1.8620178,0.15961027,0.0073629813,0.0028944414,0,8.024554,9.312762,11.075937,13.068701,13.459287,8.49664,2.2065077,0.1891396,0.008725199,0.0034299388,0,8.491703,9.854904,11.720721,13.8294935,14.242818,8.991272,2.3349593,0.20015036,0.009233136,0.0036296125,0,8.024554,9.312762,11.075937,13.068701,13.459287,8.49664,2.2065077,0.1891396,0.008725199,0.0034299388,0,6.771724,7.858812,9.346711,11.028356,11.357963,7.1701064,1.8620178,0.15961027,0.0073629813,0.0028944414,0,5.1030507,5.9222603,7.043515,8.310772,8.559158,5.4032645,1.4031833,0.12027946,0.0055486113,0.0021811994,0,3.4340985,3.985386,4.739934,5.5927353,5.7598863,3.6361272,0.94427234,0.08094207,0.0037339386,0.0014678383,0,0,0,0,0,0,0,0,0,0,0,0)
dose[,,10]<-c(1.9027942,2.103978,2.3949997,2.6736999,2.6207318,1.6177145,0.4192651,0.03526751,8.5738156E-4,1.12319985E-5,0,3.1013932,3.5011127,3.985386,4.449155,4.361014,2.6919487,0.6976757,0.058686703,0.001426721,1.8690544E-5,0,4.7051544,5.2026334,5.9222603,6.6114187,6.480442,4.0002203,1.0367421,0.08720811,0.0021200993,2.7774042E-5,0,6.2437177,6.90387,7.858812,8.773322,8.599516,5.308274,1.3757519,0.11572474,0.0028133616,3.685602E-5,0,7.3988614,8.181148,9.312762,10.396465,10.190503,6.290352,1.6302782,0.13713486,0.0033338587,4.3674718E-5,0,7.829585,8.657413,9.854904,11.001695,10.783743,6.656544,1.7251848,0.14511815,0.003527939,4.6217236E-5,0,7.3988614,8.181148,9.312762,10.396465,10.190503,6.290352,1.6302782,0.13713486,0.0033338587,4.3674718E-5,0,6.2437177,6.90387,7.858812,8.773322,8.599516,5.308274,1.3757519,0.11572474,0.0028133616,3.685602E-5,0,4.7051544,5.2026334,5.9222603,6.6114187,6.480442,4.0002203,1.0367421,0.08720811,0.0021200993,2.7774042E-5,0,3.166334,3.5011127,3.985386,4.449155,4.361014,2.6919487,0.6976757,0.058686703,0.001426721,1.8690544E-5,0,0,0,0,0,0,0,0,0,0,0,0)
dose[,,11]<-c(1.6667414,1.8771073,2.0512378,2.2073019,2.121927,1.3048903,0.34351766,0.029088901,7.142346E-4,4.757091E-6,0,2.7735314,3.1028087,3.4133508,3.6730483,3.5309806,2.1713953,0.57162863,0.048405223,0.001188518,7.91601E-6,0,4.121452,4.6416364,5.066119,5.4581285,5.247017,3.226681,0.8494369,0.07192988,0.001766131,1.1763146E-5,0,5.469147,6.15943,6.7308116,7.228586,6.9627666,4.2817907,1.1271987,0.09545062,0.0023436476,1.560964E-5,0,6.4809885,7.2989793,7.9760723,8.582914,8.250941,5.0739603,1.3357406,0.113109834,0.0027772435,1.8497563E-5,0,6.8582788,7.723889,8.440398,9.082568,8.731269,5.3652015,1.4135005,0.119694516,0.0029389204,1.9574396E-5,0,6.4809885,7.2989793,7.9760723,8.582914,8.250941,5.0739603,1.3357406,0.113109834,0.0027772435,1.8497563E-5,0,5.469147,6.15943,6.7308116,7.2429113,6.9627666,4.2817907,1.1271987,0.09542582,0.0023436476,1.560964E-5,0,4.121452,4.6416364,5.07222,5.4581285,5.247017,3.226681,0.8494369,0.07192988,0.001766131,1.1763146E-5,0,2.7735314,3.1235898,3.4133508,3.6730483,3.5309806,2.1713953,0.57162863,0.048405223,0.001188518,7.915251E-6,0,0,0,0,0,0,0,0,0,0,0,0)
contour3d(dose, level=contourlevels, color=contourcolours, alpha=contouropacity)
# axes3d()
wire3d(translate3d(scale3d(cube3d(),11/2,11/2,11/2),11/2,11/2,11/2),col = 'grey')
rgl.viewpoint( theta = 0, phi = 0)
rgl.snapshot("plot_0_0.png", fmt = "png", top = TRUE)
Sys.sleep(1)
rgl.viewpoint( theta = 0, phi = 45)
rgl.snapshot( "plot_0_45.png", fmt = "png", top = TRUE)
Sys.sleep(1)
rgl.viewpoint( theta = 45, phi = 45)
rgl.snapshot( "plot_45_45.png", fmt = "png", top = TRUE)
Sys.sleep(1)
rgl.viewpoint( theta = 90, phi = 45)
rgl.snapshot( "plot_90_45.png", fmt = "png", top = TRUE)
Sys.sleep(1)
rgl.viewpoint( theta = 90, phi = 90)
rgl.snapshot( "plot_90_90.png", fmt = "png", top = TRUE)
print("Plots Saved")
